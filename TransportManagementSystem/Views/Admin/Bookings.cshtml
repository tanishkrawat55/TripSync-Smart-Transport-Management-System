@model List<TransportManagementSystem.Models.Booking>
@using TransportManagementSystem.Models

<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">

<style>
    body {
        margin: 0;
        font-family: 'Inter', sans-serif;
        background: #0b1220;
        color: #e2e8f0;
        overflow-x: hidden;
    }

    #bookingCanvas {
        position: fixed;
        top: 0;
        left: 0;
        z-index: -1;
    }

    .page-wrapper {
        padding: 60px 50px;
    }

    .page-title {
        text-align: center;
        font-size: 2.2rem;
        font-weight: 700;
        margin-bottom: 50px;
    }

    .glass-table {
        background: rgba(255,255,255,0.04);
        backdrop-filter: blur(12px);
        border: 1px solid rgba(255,255,255,0.08);
        border-radius: 20px;
        overflow: hidden;
    }

    table {
        width: 100%;
        border-collapse: collapse;
    }

    thead {
        background: rgba(255,255,255,0.06);
    }

    th {
        padding: 16px;
        font-weight: 600;
        font-size: 0.9rem;
        text-transform: uppercase;
        letter-spacing: 0.5px;
        opacity: 0.8;
    }

    td {
        padding: 16px;
        border-top: 1px solid rgba(255,255,255,0.06);
    }

    tbody tr {
        transition: 0.3s ease;
    }

        tbody tr:hover {
            background: rgba(255,255,255,0.03);
        }

    .status-badge {
        padding: 6px 14px;
        border-radius: 20px;
        font-size: 0.8rem;
        font-weight: 500;
    }

    .Pending {
        background: #facc15;
        color: black;
    }

    .Confirmed {
        background: #38bdf8;
    }

    .Completed {
        background: #22c55e;
    }

    .approve-btn {
        background: #22c55e;
        border: none;
        padding: 6px 14px;
        border-radius: 12px;
        font-size: 0.8rem;
        font-weight: 600;
        color: white;
        transition: 0.3s ease;
        text-decoration: none;
        display: inline-block;
    }

        .approve-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(34,197,94,0.4);
        }

    .no-action {
        opacity: 0.5;
    }
</style>

<canvas id="bookingCanvas"></canvas>

<div class="page-wrapper">

    <h2 class="page-title">Booking Management</h2>

    <div class="glass-table">

        <table>
            <thead>
                <tr>
                    <th>User</th>
                    <th>Vehicle</th>
                    <th>Route</th>
                    <th>Fare</th>
                    <th>Status</th>
                    <th>Action</th>
                </tr>
            </thead>

            <tbody>
                @foreach (var booking in Model)
                {
                    <tr>
                        <td>@booking.User.FullName</td>
                        <td>@booking.Vehicle.ModelName</td>
                        <td>@booking.Source → @booking.Destination</td>
                        <td>₹@booking.TotalFare</td>

                        <td>
                            <span class="status-badge @booking.BookingStatus">
                                @booking.BookingStatus
                            </span>
                        </td>

                        <td>
                            @if (booking.BookingStatus == BookingStatus.Pending)
                            {
                                <a asp-action="ApproveBooking"
                                   asp-route-id="@booking.BookingId"
                                   class="approve-btn">
                                    Approve
                                </a>
                            }
                            else
                            {
                                <span class="no-action">No Action</span>
                            }
                        </td>

                    </tr>
                }
            </tbody>
        </table>

    </div>

</div>


<script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>

<script>
    // Animated Line Field Background (Executive Feel)

    const scene = new THREE.Scene();
    const camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 1, 2000);

    const renderer = new THREE.WebGLRenderer({
        canvas: document.getElementById('bookingCanvas'),
        alpha: true
    });

    renderer.setSize(window.innerWidth, window.innerHeight);
    camera.position.z = 600;

    const geometry = new THREE.BufferGeometry();
    const vertices = [];

    for (let i = 0; i < 2000; i++) {
        vertices.push(
            THREE.MathUtils.randFloatSpread(2000),
            THREE.MathUtils.randFloatSpread(2000),
            THREE.MathUtils.randFloatSpread(2000)
        );
    }

    geometry.setAttribute('position', new THREE.Float32BufferAttribute(vertices, 3));

    const material = new THREE.PointsMaterial({
        color: 0x38bdf8,
        size: 1.5
    });

    const points = new THREE.Points(geometry, material);
    scene.add(points);

    function animate() {
        requestAnimationFrame(animate);
        points.rotation.x += 0.0005;
        points.rotation.y += 0.0007;
        renderer.render(scene, camera);
    }

    animate();

    window.addEventListener('resize', () => {
        camera.aspect = window.innerWidth / window.innerHeight;
        camera.updateProjectionMatrix();
        renderer.setSize(window.innerWidth, window.innerHeight);
    });
</script>
